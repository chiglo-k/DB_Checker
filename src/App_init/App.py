import streamlit as st
from App_init.SQLink import SQLTable
from App_init.Fesco import Fesco
from App_init.InnerViser import InnerViser
from App_init.BLCheckFormat import BLCheckF
from App_init.InnerAgreement import InnerAgreement
from dataclasses import dataclass
import pandas as pd


@dataclass
class Init:

    def __post_init__(self):
        """
        –í—ã–∑–æ–≤ –∫–ª–∞—Å—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ—Ä–µ–π–º–∞
        :return: —Ñ—Ä–µ–π–º—ã –ø–æ –≤–∏–¥–∞–º –æ–ø–µ—Ä–∞—Ü–∏–π
        """
        self.st = st
        self.sql = SQLTable()
        self.fesco = Fesco()
        self.inner_market_save = InnerViser()
        self.bl_check = BLCheckF()
        self.inn_agg = InnerAgreement()
        self.menu_structure = {
            "–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏": [
                "–ò–Ω—Ñ–æ",
                "–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö",
                "–î—É–±–ª–∏–∫–∞—Ç—ã –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä—ã–Ω–æ–∫"
            ],
            "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º": [
                "–ó–∞–∫—Ä—ã—Ç–∏–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è",
                "–•—Ä–∞–Ω–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä—ã–Ω–æ–∫"
            ],
            "–†–∞–±–æ—Ç–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏": [
                "–†–µ–µ—Å—Ç—Ä –§–µ—Å–∫–æ"
            ]
        }

    def page_1(self):
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫, –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Ñ—Ä–µ–π–º–µ –∫–æ–Ω–æ—Å–∞–º–µ–Ω—Ç—ã
        :return: –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –∫–æ—Ç–æ—Ä—ã–º –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–æ–ø—É—Å–∫–∏,
        –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—Ä–µ–π–º—ã –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø—Ä–æ–ø—É—Å–∫–∞–º
        """
        st.header("–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–ø—É—Å–∫–∞ –¥–∞–Ω–Ω—ã—Ö")
        st.dataframe(self.sql.check_null_data(), column_config={"id": None})

    def page_2(self):
        """
        –ö–ª–∞—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–π —Ö—Ä–∞–Ω–µ–Ω–∏—è
        –¥—ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–º–∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è–º–∏
        :return: —Ç–∞–±–ª–∏—Ü—É —Å–æ–æ—Ç–≤–µ—Ç—Å–≤–∏—è –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—É BL
        """
        st.header("–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–π —Ö—Ä–∞–Ω–µ–Ω–∏—è")
        self.bl_check.bl_check_run()

    def page_4(self):
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–∏
        """
        st.header("–•—Ä–∞–Ω–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä—ã–Ω–æ–∫")
        self.inner_market_save.inner_create()

    def page_5(self):
        """–†–µ–µ—Å—Ç—Ä —Å—á–µ—Ç–æ–≤ –§–µ—Å–∫–æ/–î–∞–ª—å—Ä–µ—Ñ—Ç—Ä–∞–Ω—Å"""
        st.header("–†–µ–µ—Å—Ç—Ä —Å—á–µ—Ç–æ–≤ –§–µ—Å–∫–æ/–î–∞–ª—å—Ä–µ—Ñ—Ç—Ä–∞–Ω—Å")
        options = ["–†–µ–µ—Å—Ç—Ä –§–µ—Å–∫–æ/–î–∞–ª—å—Ä–µ—Ñ—Ç—Ä–∞–Ω—Å",
                   "–†–µ–µ—Å—Ç—Ä –Ω–µ –∑–∞–∫—Ä—ã—Ç—ã—Ö —Å—á–µ—Ç–æ–≤ –§–µ—Å–∫–æ/–î–∞–ª—å—Ä–µ—Ñ—Ç—Ä–∞–Ω—Å",
                   "–î–æ–±–∞–≤–∏—Ç—å —Å—á–µ—Ç",
                   "–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–ª–∞—Ç–µ–∂–µ",
                   "–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é",
                   "–£–¥–∞–ª–∏—Ç—å —Å—á–µ—Ç"]

        selection = st.pills("Directions", options, selection_mode="single")

        if selection == "–î–æ–±–∞–≤–∏—Ç—å —Å—á–µ—Ç":
            self.fesco.form_registration()
        elif selection == "–†–µ–µ—Å—Ç—Ä –Ω–µ –∑–∞–∫—Ä—ã—Ç—ã—Ö —Å—á–µ—Ç–æ–≤ –§–µ—Å–∫–æ/–î–∞–ª—å—Ä–µ—Ñ—Ç—Ä–∞–Ω—Å":
            self.fesco. unclosed_bill()
        elif selection == "–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–ª–∞—Ç–µ–∂–µ":
            self.fesco.form_close_registration()
        elif selection == "–†–µ–µ—Å—Ç—Ä –§–µ—Å–∫–æ/–î–∞–ª—å—Ä–µ—Ñ—Ç—Ä–∞–Ω—Å":
            self.fesco.data_fesco_show()
        elif selection == "–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é":
            self.fesco.add_new_service()
        elif selection == "–£–¥–∞–ª–∏—Ç—å —Å—á–µ—Ç":
            self.fesco.delete_fesco_bill()

    def page_6(self):
        st.header("–†–µ–µ—Å—Ç—Ä –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä—ã–Ω–æ–∫")
        self.inn_agg.show_agreement()

    def run_app(self):
        st.sidebar.title('Checker Of DB')
        st.sidebar.title('–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª')

        category = st.sidebar.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é", list(self.menu_structure.keys()))

        # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        pages = self.menu_structure[category]
        page = st.sidebar.radio("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª", pages)

        with st.spinner('üîÑ –û–∂–∏–¥–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö...'):
            if page == "–ò–Ω—Ñ–æ":
                # –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                st.markdown("# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö")

                # –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
                st.divider()

                # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫
                checks = [
                    "‚Ä¢ –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö: –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω–æ—Å–∞–º–µ–Ω—Ç–æ–≤ –Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö",
                    "‚Ä¢ –î—É–±–ª–∏–∫–∞—Ç—ã –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä—ã–Ω–æ–∫: –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä—ã–Ω–æ–∫)",
                    "‚Ä¢ –ó–∞–∫—Ä—ã—Ç–∏–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è: –∞–Ω–∞–ª–∏–∑ –ë–î –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –Ω–µ –∑–∞–∫—Ä—ã—Ç—ã—Ö –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–π –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–π —Ö—Ä–∞–Ω–µ–Ω–∏—è",
                    "‚Ä¢ –•—Ä–∞–Ω–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä—ã–Ω–æ–∫: –Ω–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è –ø–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É —Ä—ã–Ω–∫—É",
                    "‚Ä¢ –†–µ–µ—Å—Ç—Ä –§–µ—Å–∫–æ: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ[—É–¥–∞–ª–µ–Ω–∏–µ] —Å—á–µ—Ç–æ–≤/–ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –ø–æ—Ä—É—á–µ–Ω–∏–π –ø–æ —Å—á–µ—Ç–∞–º –≥—Ä—É–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –§–µ—Å–∫–æ/–î–∞–ª—å—Ä–µ—Ñ—Ç—Ä–∞–Ω—Å"
                ]

                # –í—ã–≤–æ–¥–∏–º –∫–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç —Å –æ—Ç—Å—Ç—É–ø–æ–º –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
                for check in checks:
                    st.caption(check)

                # –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø –ø–æ—Å–ª–µ —Å–ø–∏—Å–∫–∞
                st.markdown("")
            elif page == "–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö":
                self.page_1()
            elif page == "–ó–∞–∫—Ä—ã—Ç–∏–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è":
                self.page_2()
            elif page == "–•—Ä–∞–Ω–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä—ã–Ω–æ–∫":
                self.page_4()
            elif page == "–†–µ–µ—Å—Ç—Ä –§–µ—Å–∫–æ":
                self.page_5()
            elif page == "–î—É–±–ª–∏–∫–∞—Ç—ã –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä—ã–Ω–æ–∫":
                self.page_6()
